@startuml ERP_Tunisie_Class_Diagram

!theme plain
skinparam classAttributeIconSize 0
skinparam classFontSize 10
skinparam packageFontSize 12
skinparam packageFontStyle bold

title ERP Tunisie - Diagramme de Classes

' ========== PACKAGE 1: GESTION DE LA RELATION CLIENT (CRM) ==========
package "1. Gestion de la Relation Client (CRM)" as CRM {
    class Client {
        +int Id
        +string Nom
        +string Prenom
        +string RaisonSociale
        +string TypeClient
        +string ICE
        +string Adresse
        +string Ville
        +string CodePostal
        +string Pays
        +string Telephone
        +string Email
        +string Classification
        +decimal LimiteCredit
        +decimal SoldeActuel
        +bool EstActif
        +DateTime DateCreation
        +List<ContactClient> Contacts
        +List<TransactionClient> HistoriqueAchats
    }

    class ContactClient {
        +int Id
        +string Nom
        +string Poste
        +string Telephone
        +string Email
        +string Role
    }

    class TransactionClient {
        +int Id
        +int ClientId
        +DateTime DateTransaction
        +decimal Montant
        +string Type
        +string Reference
    }

    class AnalyseClient {
        +int ClientId
        +decimal ValeurVieClient
        +int NombreTransactions
        +decimal MontantMoyenAchat
        +int RisqueCredit
        +string Segment
    }

    Client ||--o{ ContactClient : "1..*"
    Client ||--o{ TransactionClient : "1..*"
    Client ||--|| AnalyseClient : "1..1"
}

' ========== PACKAGE 2: GESTION DE LA RELATION FOURNISSEUR (SRM) ==========
package "2. Gestion de la Relation Fournisseur (SRM)" as SRM {
    class Fournisseur {
        +int Id
        +string RaisonSociale
        +string TypeFournisseur
        +string ICE
        +string Adresse
        +string Ville
        +string CodePostal
        +string Pays
        +string Telephone
        +string Email
        +string ConditionsPaiement
        +int DelaiLivraisonMoyen
        +decimal NoteQualite
        +List<ContactFournisseur> Contacts
        +List<TransactionFournisseur> HistoriqueAchats
    }

    class ContactFournisseur {
        +int Id
        +string Nom
        +string Poste
        +string Telephone
        +string Email
    }

    class TransactionFournisseur {
        +int Id
        +int FournisseurId
        +DateTime DateTransaction
        +decimal Montant
        +string Type
    }

    class PerformanceFournisseur {
        +int FournisseurId
        +decimal VolumeAchatAnnuel
        +int TauxLivraisonATemps
        +decimal NotePerformance
    }

    Fournisseur ||--o{ ContactFournisseur : "1..*"
    Fournisseur ||--o{ TransactionFournisseur : "1..*"
    Fournisseur ||--|| PerformanceFournisseur : "1..1"
}

' ========== PACKAGE 3: GESTION DES RESSOURCES HUMAINES ==========
package "3. Gestion des Ressources Humaines" as HR {
    class Employe {
        +int Id
        +string Nom
        +string Prenom
        +string CIN
        +string Poste
        +string Departement
        +decimal SalaireBase
        +decimal Prime
        +DateTime DateEmbauche
        +string Statut
        +List<ActiviteEmploye> Activites
    }

    class ActiviteEmploye {
        +int Id
        +int EmployeId
        +DateTime DateActivite
        +string Type
        +string Description
        +decimal Montant
    }

    class Department {
        +int Id
        +string Nom
        +string Description
        +int? ManagerId
        +bool EstActif
        +DateTime DateCreation
        +DateTime? DateModification
        +string CreePar
        +string ModifiePar
    }

    Employe ||--o{ ActiviteEmploye : "1..*"
    Department ||--o{ Employe : "1..*"
    Department ||--o| Employe : "0..1" as Manager
}

' ========== PACKAGE 4: GESTION DES PRODUITS ET STOCKS ==========
package "4. Gestion des Produits et Stocks" as INVENTORY {
    class Category {
        +int Id
        +string Nom
        +string Description
        +int? CategorieParentId
        +bool EstActif
        +DateTime DateCreation
        +DateTime? DateModification
        +string CreePar
        +string ModifiePar
    }

    class Produit {
        +int Id
        +string Reference
        +string Designation
        +string Description
        +string Categorie
        +string SousCategorie
        +decimal PrixAchat
        +decimal PrixVente
        +decimal PrixVenteMin
        +string Unite
        +string Statut
        +int StockActuel
        +int StockMinimum
        +int StockMaximum
        +List<VariantProduit> Variantes
    }

    class VariantProduit {
        +int Id
        +int ProduitId
        +string Taille
        +string Couleur
        +string ReferenceVariant
        +int StockActuel
    }

    class MouvementStock {
        +int Id
        +int ProduitId
        +DateTime DateMouvement
        +string Type
        +int Quantite
        +string ReferenceDocument
        +string Emplacement
    }

    class Inventaire {
        +int Id
        +int ProduitId
        +int QuantiteTheorique
        +int QuantiteReelle
        +DateTime DateInventaire
        +string Ecarts
    }

    Category ||--o{ Category : "1..*" as SousCategories
    Category ||--o{ Produit : "1..*"
    Produit ||--o{ VariantProduit : "1..*"
    Produit ||--o{ MouvementStock : "1..*"
    Produit ||--o{ Inventaire : "1..*"
}

' ========== PACKAGE 5: GESTION DES VENTES ==========
package "5. Gestion des Ventes" as SALES {
    class Devis {
        +int Id
        +int ClientId
        +DateTime DateCreation
        +DateTime DateExpiration
        +string Statut
        +decimal MontantHT
        +decimal MontantTTC
        +decimal Remise
        +List<LigneDevis> Lignes
    }

    class LigneDevis {
        +int Id
        +int DevisId
        +int ProduitId
        +int Quantite
        +decimal PrixUnitaire
        +decimal TotalLigne
    }

    class CommandeVente {
        +int Id
        +int ClientId
        +int DevisId
        +DateTime DateCommande
        +string Statut
        +decimal MontantHT
        +decimal MontantTTC
        +string ModeLivraison
        +string ConditionsPaiement
        +List<LigneCommandeVente> Lignes
    }

    class LigneCommandeVente {
        +int Id
        +int CommandeId
        +int ProduitId
        +int Quantite
        +decimal PrixUnitaire
        +decimal TotalLigne
    }

    class Livraison {
        +int Id
        +int CommandeId
        +DateTime DateLivraison
        +string Statut
        +string Transportateur
        +string NumeroSuivi
        +List<LigneLivraison> Lignes
    }

    class LigneLivraison {
        +int Id
        +int LivraisonId
        +int ProduitId
        +int Quantite
    }

    class FactureVente {
        +int Id
        +int CommandeId
        +int ClientId
        +DateTime DateFacture
        +DateTime DateEcheance
        +string Statut
        +decimal MontantHT
        +decimal MontantTTC
        +decimal MontantPaye
        +List<LigneFactureVente> Lignes
    }

    class LigneFactureVente {
        +int Id
        +int FactureId
        +int ProduitId
        +int Quantite
        +decimal PrixUnitaire
        +decimal TotalLigne
    }

    class RetourVente {
        +int Id
        +int FactureId
        +int ClientId
        +DateTime DateRetour
        +string Motif
        +string Statut
        +List<LigneRetourVente> Lignes
    }

    class LigneRetourVente {
        +int Id
        +int RetourId
        +int ProduitId
        +int Quantite
    }

    ' Relations Sales
    Client ||--o{ Devis : "1..*"
    Devis ||--o{ LigneDevis : "1..*"
    Client ||--o{ CommandeVente : "1..*"
    Devis ||--o| CommandeVente : "0..1"
    CommandeVente ||--o{ LigneCommandeVente : "1..*"
    CommandeVente ||--o{ Livraison : "1..*"
    Livraison ||--o{ LigneLivraison : "1..*"
    CommandeVente ||--o{ FactureVente : "1..*"
    Client ||--o{ FactureVente : "1..*"
    FactureVente ||--o{ LigneFactureVente : "1..*"
    FactureVente ||--o{ RetourVente : "1..*"
    Client ||--o{ RetourVente : "1..*"
    RetourVente ||--o{ LigneRetourVente : "1..*"
}

' ========== PACKAGE 6: GESTION DES ACHATS ==========
package "6. Gestion des Achats" as PURCHASE {
    class DemandeAchat {
        +int Id
        +int EmployeId
        +DateTime DateDemande
        +string Statut
        +List<LigneDemandeAchat> Lignes
    }

    class LigneDemandeAchat {
        +int Id
        +int DemandeId
        +int ProduitId
        +int Quantite
        +string Justification
    }

    class CommandeAchat {
        +int Id
        +int FournisseurId
        +int DemandeId
        +DateTime DateCommande
        +DateTime DateLivraisonPrevue
        +string Statut
        +decimal MontantHT
        +decimal MontantTTC
        +List<LigneCommandeAchat> Lignes
    }

    class LigneCommandeAchat {
        +int Id
        +int CommandeId
        +int ProduitId
        +int Quantite
        +decimal PrixUnitaire
        +decimal TotalLigne
    }

    class Reception {
        +int Id
        +int CommandeId
        +DateTime DateReception
        +string Statut
        +List<LigneReception> Lignes
    }

    class LigneReception {
        +int Id
        +int ReceptionId
        +int ProduitId
        +int Quantite
        +string Qualite
    }

    class FactureAchat {
        +int Id
        +int CommandeId
        +int FournisseurId
        +DateTime DateFacture
        +DateTime DateEcheance
        +string Statut
        +decimal MontantHT
        +decimal MontantTTC
        +decimal MontantPaye
        +List<LigneFactureAchat> Lignes
    }

    class LigneFactureAchat {
        +int Id
        +int FactureId
        +int ProduitId
        +int Quantite
        +decimal PrixUnitaire
        +decimal TotalLigne
    }

    ' Relations Purchase
    Employe ||--o{ DemandeAchat : "1..*"
    DemandeAchat ||--o{ LigneDemandeAchat : "1..*"
    Fournisseur ||--o{ CommandeAchat : "1..*"
    DemandeAchat ||--o| CommandeAchat : "0..1"
    CommandeAchat ||--o{ LigneCommandeAchat : "1..*"
    CommandeAchat ||--o{ Reception : "1..*"
    Reception ||--o{ LigneReception : "1..*"
    CommandeAchat ||--o{ FactureAchat : "1..*"
    Fournisseur ||--o{ FactureAchat : "1..*"
    FactureAchat ||--o{ LigneFactureAchat : "1..*"
}

' ========== PACKAGE 7: GESTION FINANCIÈRE ==========
package "7. Gestion Financière" as FINANCE {
    class PaiementClient {
        +int Id
        +int FactureId
        +int ClientId
        +DateTime DatePaiement
        +decimal Montant
        +string ModePaiement
        +string Reference
    }

    class PaiementFournisseur {
        +int Id
        +int FactureId
        +int FournisseurId
        +DateTime DatePaiement
        +decimal Montant
        +string ModePaiement
        +string Reference
    }

    ' Relations Finance
    FactureVente ||--o{ PaiementClient : "1..*"
    Client ||--o{ PaiementClient : "1..*"
    FactureAchat ||--o{ PaiementFournisseur : "1..*"
    Fournisseur ||--o{ PaiementFournisseur : "1..*"
}

' ========== PACKAGE 8: REPORTING ET ANALYTICS ==========
package "8. Reporting et Analytics" as REPORTING {
    class RapportVente {
        +DateTime DateDebut
        +DateTime DateFin
        +decimal ChiffreAffaires
        +decimal MargeBrute
        +int NombreClients
        +int NombreCommandes
        +Dictionary<string, decimal> VentesParCategorie
    }

    class RapportAchat {
        +DateTime DateDebut
        +DateTime DateFin
        +decimal DepensesTotales
        +int NombreFournisseurs
        +int NombreCommandes
        +Dictionary<string, decimal> AchatsParCategorie
    }

    class RapportStock {
        +DateTime DateInventaire
        +decimal ValeurStock
        +int NombreProduits
        +int NombreProduitsRupture
        +Dictionary<string, int> StockParCategorie
    }

    class SalesReport {
        +DateTime DateRapport
        +decimal VentesTotales
        +int TotalCommandes
        +decimal ValeurMoyenneCommande
        +int ClientId
        +string NomClient
        +int ProduitId
        +string NomProduit
        +int EmployeId
        +string NomEmploye
    }

    class InventoryReport {
        +int ProduitId
        +string NomProduit
        +string Reference
        +int StockActuel
        +int NiveauReapprovisionnement
        +decimal ValeurStock
        +string NomCategorie
        +int JoursEnStock
        +string StatutStock
    }

    class FinancialReport {
        +DateTime DateRapport
        +decimal ChiffreAffairesTotal
        +decimal CoutsTotaux
        +decimal BeneficeBrut
        +decimal BeneficeNet
        +decimal CreancesClients
        +decimal DettesFournisseurs
        +decimal FluxTresorerie
    }
}

' ========== PACKAGE 9: ADMINISTRATION SYSTÈME ==========
package "9. Administration Système" as ADMIN {
    class Utilisateur {
        +int Id
        +string NomUtilisateur
        +string MotDePasse
        +string Role
        +int EmployeId
        +bool EstActif
    }

    class CompanySettings {
        +int Id
        +string NomSociete
        +string Adresse
        +string Telephone
        +string Email
        +string ICE
        +string Devise
        +decimal TauxTVA
        +string Logo
        +DateTime DateCreation
        +DateTime? DateModification
        +string CreePar
        +string ModifiePar
    }

    class ParametreSociete {
        +string NomSociete
        +string ICE
        +string Adresse
        +string Ville
        +string Telephone
        +string Email
        +string Logo
        +string Devise
        +decimal TauxTVA
    }

    class SequenceNumerique {
        +string TypeDocument
        +string Prefixe
        +int ProchainNumero
        +int Longueur
    }

    class AuditLog {
        +int Id
        +int UtilisateurId
        +DateTime DateAction
        +string Action
        +string TableAffectee
        +string AncienneValeur
        +string NouvelleValeur
        +string IPAddress
    }

    class ReturnValueResponse<T> {
        +string SuccessMessage
        +bool IsSuccess
        +string ErrorMessage
        +HttpStatusCode StatusCode
        +T Data
    }

    ' Relations Admin
    Employe ||--o| Utilisateur : "0..1"
    Utilisateur ||--o{ AuditLog : "1..*"
}

' ========== PACKAGE 10: ENUMS ==========
package "10. Enums" as ENUMS {
    enum CustomerType {
        Individuel
        Entreprise
        Grossiste
        Detailant
    }

    enum OrderStatus {
        Brouillon
        Confirme
        Expedie
        Livre
        Complete
        Annule
    }

    enum PaymentMethod {
        Espece
        Cheque
        CarteCredit
        Virement
        Autre
    }

    enum ProductStatus {
        Actif
        Inactif
        Discontinue
        Rupture
    }

    enum PaymentTerms {
        Net15
        Net30
        Net45
        Net60
        Immediate
        Personnalise
    }

    enum StockMovementType {
        Achat
        Vente
        Ajustement
        Transfert
        Dommage
        Expire
        Retour
    }

    enum SupplierType {
        Fabricant
        Distributeur
        Grossiste
        FournisseurService
    }

    enum UserRole {
        Admin
        Vendeur
        Acheteur
        Inventaire
        Comptable
        RH
    }
}

' ========== PACKAGE 11: BASE ENTITY ==========
package "11. Base Entity" as BASE {
    abstract class BaseEntity {
        +int Id
        +DateTime DateCreation
        +DateTime? DateModification
        +string CreePar
        +string ModifiePar
    }
}

' ========== RELATIONS CROSS-PACKAGE ==========
' Relations entre packages
Client ||--o{ Devis : "1..*"
Client ||--o{ CommandeVente : "1..*"
Client ||--o{ FactureVente : "1..*"
Client ||--o{ PaiementClient : "1..*"

Fournisseur ||--o{ CommandeAchat : "1..*"
Fournisseur ||--o{ FactureAchat : "1..*"
Fournisseur ||--o{ PaiementFournisseur : "1..*"

Produit ||--o{ LigneDevis : "1..*"
Produit ||--o{ LigneCommandeVente : "1..*"
Produit ||--o{ LigneFactureVente : "1..*"
Produit ||--o{ LigneCommandeAchat : "1..*"
Produit ||--o{ LigneFactureAchat : "1..*"
Produit ||--o{ LigneDemandeAchat : "1..*"
Produit ||--o{ LigneReception : "1..*"
Produit ||--o{ LigneLivraison : "1..*"
Produit ||--o{ LigneRetourVente : "1..*"

Employe ||--o{ DemandeAchat : "1..*"
Employe ||--o| Utilisateur : "0..1"

' Héritage
BaseEntity <|-- Category
BaseEntity <|-- Department
BaseEntity <|-- CompanySettings

@enduml
